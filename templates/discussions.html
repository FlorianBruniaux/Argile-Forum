<html>
    <head>
	<link rel="stylesheet" href="style/forum.css" type="text/css">
        <script src="/_utils/script/sha1.js"></script>
  	<script src="/_utils/script/json2.js"></script>
  	<script src="/_utils/script/jquery.js"></script>
  	<script src="/_utils/script/jquery.couch.js"></script> 
 	<script src="js/script.js"></script>
        
	<script type="text/javascript">
            
            //Enregistrer un nouvel utilisateur
            function enregistrement(){
                var login = $('#enregistrementNom').val();
                var mdp = $('#enregistrementMdp').val();
                var email = $('#enregistrementEmail').val();
                
                enregistrer(login,mdp,email);
            }
            
            //Se connecter
            function connexion(){
                var login = $('#connexionNom').val();
                var mdp = $('#connexionMdp').val();
               // alert("connexion");
                connecter(login,mdp);
            }
            
            //Créer une nouvelle page de discussion
            function creerDiscussion(){
                titre = $("input#title").val();
                texte = $("#textarea-sum").val();
                var typeObjet = document.getElementById("select-type");
                var val_type_objet = typeObjet.options[typeObjet.selectedIndex].value;

                var auteur = verifierConnexion();
                
                nouvelleConversation(auteur, titre, texte, val_type_objet,null);       
            }
        
            //Afficher/Masquer le formulaire de connexion
            function afficherFormConnexion(){
                reg = document.getElementById("register");
                log = document.getElementById("login");
                if(log.style.display=="none"){
                    log.style.display="block";    
                    reg.style.display="none";
                }
                else{
                    log.style.display="none";
                }  
            }
            
            //Afficher/Masquer le formulaire d'enregistrement d'un nouveau compte'
            function afficherFormEnregistrement(){
                reg = document.getElementById("register");
                log = document.getElementById("login");
                if(reg.style.display=="none"){
                    reg.style.display="block";
                    log.style.display="none";
                }
                else{
                    reg.style.display="none";
                }
            }
        
            
  	</script>
    </head>
  <body>
        <div id="header">
            <div id="titre">Argile-forum</div>
            <div id="ident">
                <a href="#" onclick="afficherFormConnexion()">Connexion</a> - <a href="#" onclick="afficherFormEnregistrement()">S'enregistrer</a>
            </div>
        </div>
        <div id="login" style="display: none">
            <h2>Connexion</h2>
            <form id="form-login">
                <input type="text" name="login" id="connexionNom" autofocus required placeholder="Nom d'utilisateur?">
                <input type="password" name="mdp" id="connexionMdp" required placeholder="Mot de passe?"><br><br>
                <div class="send-button" onclick="connexion()">
                    Connexion
                </div>
            </form>
        </div>
        <div id="register" style="display: none">
            <h2>S'enregistrer</h2>
            <form id="form-register">
                <input type="text" name="login" id="enregistrementNom" required placeholder="Nom d'utilisateur?">
                <input type="password" name="mdp" id="enregistrementMdp" required placeholder="Mot de passe?">
                <input type="email" name="email" id="enregistrementEmail" required placeholder="Email?"><br><br>
                <div class="send-button" onclick="enregistrement()">
                    S'enregistrer
                </div>
            </form>
        </div>
          
        <div id="question">
          <h2>Fils de discussion</h2>
        </div>
        <!--
        Liste des discussions
        -->
        <div id="content">
            <div class="topic" id="topic">       
                <table id="topic-summary">
                    <tr class="topic-row-header">
                        <td class="topic-summary-row-title">
                            Titre
                        </td>
                        <td class="topic-summary-row">
                            Date de modifitcation
                        </td>

                    </tr>               
                {{#discussions}}
                    <tr>
                        <td class="topic-summary-row">
                            <a href='_rewrite/discussion/{{id}}'>{{titre}}</a>
                        </td>
                        <td class="topic-date-row">
                            {{date_modification}}
                        </td>
                    </tr>
                           
                {{/discussions}}
                </table>
                <!--
                Formulaire de création de discussion
                -->
                <div id="summary">
                        <form name="form" id="form">
                            <table>
                                    <tr>
                                        <td>Nouveau fil de discussion</td>
                                        <td><input type="text" name="title" id="title" value=""/></td>

                                    </tr>
                                    <tr>
                                        <td>Type : </td>
                                        <td><select id="select-type">
                                                <option value="scene">Scène</option>
                                                <option value="action">Action</option>
                                                <option value="objet">Objet</option>
                                            </select></td>

                                    </tr>
                                    <tr>
                                        <td>Résumé</td>
                                        <!--<td><input type="text" name="text" id="text" value=""/></td>-->
                                        <td><textarea rows="5" cols="80" id="textarea-sum"></textarea></td>
                                    </tr>
                            </table>
                            <div class="send-button" onclick="creerDiscussion()">
                                Envoyer
                            </div>
                        </form>
                </div>
            </div>
            <div id="related">
                <h4 class="header-related">
                    Derniers objets créés
                </h4>
            </div>  
        </div>
      <div id="footer">
            
        </div>
    </body>
</html>